# TVonDemand
Repository for the Databases project - MySQL + Java
Description The database concerns an on-demand movie service provided by a television content provider. The following functional requirements are covered by the relational schema provided to you:

For each movie, a unique code, title, description, release year, available languages, duration, suitability rating, and special edition features are stored. For each language the movie is available in, a code and its name are stored in the system. For each actor participating in a movie, a unique code, first name, and last name are recorded in the system. Each actor can participate in multiple movies, and multiple actors can participate in one movie. Information about movie categories is maintained (unique code in the system and genre, e.g., drama, comedy, etc.). No category belongs to another category. Also, a movie can belong to multiple categories, and obviously, multiple movies can belong to the same category. The following information is kept for each customer: a unique code, first name, last name, email, address, whether they are an active customer or not, and the registration date. For the sake of design simplification, the email serves as the customer's username for the service, and no password is used. For each address, a unique code, street number, area, city, postal code, and phone number are stored. For each city, a unique code, the city's name, and the country to which the city belongs are kept. Similarly, for each country, a unique code and the country's name are stored. Each customer has one address, while the same address can belong to many customers. Each city contains many addresses, and each country has many cities. The service provides its customers with a catalog of movies available for viewing with a charge. The catalog may not contain all the movies registered in the database. From this catalog, customers can select and request to watch any movie. For a movie rental request, a unique code, rental date, the code of the movie in the catalog, and the customer's code are stored. Each customer can rent any movie (the same or different) they want, and each movie is available to all customers, regardless of whether someone is watching it or not. The customer pays for each rental request. For each payment, a unique code, the customer's code, the rental request code, the payment amount, and the payment date are stored. Each payment corresponds to a movie rental request.

Part A: Database Design and SQL The provider of television content wishes to upgrade the service so that, in addition to movies, registered users also have access to TV series. In the first phase, it will be necessary to expand the database to maintain information regarding:

The three user categories to be connected to the database: i. Customers who register for the service and have the ability to watch available television content for a fee. Information for this category already exists in the relational schema provided to you. ii. Employees of the provider who update the available television content of the service and monitor its operation. iii. System administrators who manage the service.Each customer will be able to register to watch only movies, only TV series, or both. Depending on the type of registration, they will have access only to the corresponding content. The rental cost, depending on the type of registration, is as follows:Registration Type Cost Movies only €0.4 per movie Requirements: You will deliver a report with the entire documentation and the complete SQL code. The documentation concerns parts A and B described below. Specifically for part B, it is required to explain its functionality using screenshots. Additionally, you will submit a .zip file containing the above, and the complete code for parts A and B, and all files required to demonstrate the code. Submission instructions can be found below. Specifically, the requirements are as follows:

Design the revised database. In your report in chapter 1, you will include: A) The relational diagram of the overall revised database (after the extensions mentioned above), and B) a description of all the assumptions of your design, the new tables, and the modifications you made to existing tables. Create the new tables resulting from the above design in the database by preparing a set of create and insert commands. Enter a sufficient volume of data that will allow testing of the correct operation of the database and the proper execution of queries, triggers, and stored procedures that are requested subsequently. In your report in chapter 2, include commentary on the new tables you had to create to implement the following requirements. Create the following stored procedures. In chapter 3 of your report, provide the code and examples from the execution of the stored procedures:3.1 A stored procedure where the inputs are a character ('m' or 's'), a number (quantity), and two dates. The result of the Procedure will be the codes and full titles of movies (if the first input argument is 'm') or the codes and full titles of TV series (if the first input argument is 's') with the most rentals in the time period defined by the two dates in the input arguments. The number of movies or series included in the result will be determined by the number given as the second input argument. Rentals for each series are calculated as the sum of the rentals of all episodes of all seasons.For example, if we provide arguments ('m', 5, '2021-11-01', '2021-11-30'), we should get the codes and titles of the top 5 movies with the most rentals in November 2021.3.2 A stored procedure where the input is a customer's email and a date. It returns the number of rentals made by this customer on that date. Rentals can be for movies, series, or both, depending on the type of registration the customer has made for the service.3.3 A stored procedure that displays income from payments per month. In each month, the income from movies and series will be calculated separately.Hint: Refer to MySQL date and time functions for managing time values (https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_month).3.4 a) A stored procedure that takes two surnames as input parameters and returns the names, surnames, and the number of actors whose surname is between the two input parameters. For example, if we give the parameters 'Aco' and 'Alm', it should return all actors whose surname starts with 'Aco' and all surnames of actors up to those starting with 'Alm'.b) A stored procedure where the input parameter is the surname of an actor and it returns the names and surnames of the actors with that surname. If there are more than one, it also returns the number of actors.Due to the large number of records, you will need to create an additional index. Depending on the question, you should choose the appropriate type of index and justify your choice in each case.Hint: Refer to MySQL index and hashing table creation (https://dev.mysql.com/doc/refman/5.7/en/create-index.html). 4. Create the following triggers. In chapter 4 of your report, provide the code and examples (screenshots) from the execution of the triggers: 4.1. A trigger that updates the relevant action log table for every insertion, update, or deletion action in the rental, payment tables, and any other table you create that is involved in the process of viewing a movie or TV series episode.

4.2. A trigger that, for every third time the same user requests to watch a movie or TV series episode on the same day, grants a 50% discount. (You can use query 3.2)

4.3. A trigger that prevents the modification if any customer tries to change details in their profile that are not allowed to be altered. TV series only €0.2 per episode of a TV series Both €0.3 per movie and €0.1 per episode of a TV seriesThe database schema needs to be modified to support the above requirement. For example, the method by which the customer will access the respective catalog (movies, TV series, or both) depending on their registration needs to be provided. Information about available TV series. This information will be similar to the information for movies with additional elements specific to TV series, such as seasons, number of episodes per season, release year of each season, etc. At least two tables need to be added to store information about TV series, seasons, and episodes. These tables should be appropriately connected with existing information in the database, such as actors, available languages, and categories (e.g., drama, comedy). Additionally, tables like inventory may need to be created or modified to make TV series available to customers. Depending on your design, other tables involved in the content rental and payment process, such as rental and payment, may need to be redesigned as well. Maintenance of a log table. A table should be created to record actions performed by any user (customer, employee, administrator) on specific tables through the application you will implement in Part B. This table should be updated every time an action to insert, update, or delete data is attempted. It should record the username of the user, the date and time of the event, whether it was successful or not, the type of action (insert, update, or delete), and the name of the table involved. Part B: GUIs

The database will require a set of interfaces to be used by different user categories that will have access to it. Note that implementing these interfaces may require some revisions to the design (e.g., adding some fields to tables).

Construct the three interfaces described below in Java using an IDE of your choice (Eclipse, NetBeans, etc.). Additionally, you should construct an initial login page where each user will enter their email as their username. The administrator should also be added to the database as a user. Depending on the category of each user, the appropriate GUI from the following should be displayed: Customer: Can view and edit their account details, but cannot change their email. Can change their subscription type (movies only, series only, or both). Has access to their rental details. Has access to the catalog of available content based on their subscription type. Can make a new rental and payment. Employee: Can view the customer directory and edit all their details except their email. Has access to the rental details of customers. Can update tables with information about actors, movies, series, languages, categories, addresses, cities, countries, and the catalog of available movies and series. Can display the top 5 movies and series with the most rentals for the previous month from the execution date of the query. (Query 3.1 can be used) Administrator: Can create new accounts in the system for customers and employees. Can delete existing accounts for customers and employees. Can change an employee to an administrator and vice versa. Can display the total rental income per month. (Query 3.3 can be used) Can change the rental prices of movies and series. (1 mark). Where possible, data entry in the GUI should be restricted to avoid errors and speed up processes (e.g., selection from menus or lists). The available options will be based on the data in the database.For example, if an employee wants to view rental prices for movies and series by subscription type, they should be displayed in a list. However, because an employee is not allowed to change the prices, these should appear as non-editable (locked) items. Conversely, for an administrator, who is allowed to make this change, these items should not be locked for editing.Additionally, the administrator should be able to view the log table entries related to a specific table or user in the database. This will be done by entering (or selecting) a specific table or user and a time interval.
